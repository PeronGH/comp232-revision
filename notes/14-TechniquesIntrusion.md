# Techniques for Intrusion Detection

## Statistical Analysis Approach
- User or system behavior (set of attributes) is measured by a number of variables over time
- Examples of variables: user login/logout, number of files accessed in a period of time, usage of disk space, memory, CPU, etc.
- Frequency of updating can vary from minutes to months
- System stores mean values for each variable and detects when a value exceeds a predefined threshold
- More sophisticated model: short- and long-term user profiles

## Neural Networks and Machine Learning
- Neural networks use learning algorithms to learn about the relationship between input and output
- Main purpose: learn the behavior of actors in the system (e.g., users, processes)
- Advantages over statistics:
  - Simple way to express nonlinear relationships between variables
  - Learning about relationships automatically
- Disadvantage: computationally intensive technique
- Neural networks can be used to predict behavior of users and super-users (roots)
- Other machine learning techniques may also be used

## Rule-Based (Expert) Systems
- Work on a previously defined set of rules describing an attack
- All security-related events are translated in terms of if-then-else rules
- Inference engine may be used to infer conclusions
- Examples: Wisdom & Sense and ComputerWatch (developed at AT&T)

## Signature-Based Method
- Example of a signature:
  ```
  alert icmp $EXTERNAL_NET any -> $HOME_NET any (msg:"MISC large ICMP"; dsize: >800; reference:arachnids,246; classtype:bad-unknown; sid:499;)
  ```
  Alarm raised if an ICMP packet incoming from the external network, associated with any port, and having a size greater than 800 bytes
- Advantages:
  - Very low false alarm rate
  - Simple algorithms, easy implementation
- Disadvantages:
  - Difficulties in updating information on new types of attacks
  - Unable to detect unknown attacks (knowledge-based)

## State-Transition Analysis
- An attack is described with a set of goals and transitions that must be achieved by an intruder to compromise a system
- Transitions are represented on state-transition diagrams
- Inference engine matches current audit records with attack descriptions: event-driven, forward-chaining

## Computer Immunology
- Analogies with immunology: constructs a model of normal behavior of (UNIX) network services, rather than that of individual users
- Model consists of short sequences of system calls made by the processes
- Assumption: attacks that exploit flaws in the application code are likely to take unusual execution paths
- Model has two parts:
  - Audit data representing the appropriate behavior of services
  - Knowledge base with all the known "good" sequences of system calls
- Stored patterns are used for monitoring system calls to check whether the generated sequence is listed in the knowledge base; if not, an alarm is generated
- Example: pattern of normal behavior:
  ```
  open, read, mmap, mmap, open, getrlimit, mmap, close (system calls in UNIX)
  ```
  Information about all sequences of a certain length (e.g., 3) may be stored in the knowledge base
- Advantages:
  - Potentially very low false alarm rate (if knowledge base is complete enough)
  - Updating the knowledge base can be done online
- Disadvantages:
  - If an attacker uses legitimate actions to gain unauthorized access, no alarm will be generated
  - Arguments of system calls are not taken into account

## User Intention Identification
- Models normal user behavior by the set of high-level tasks they have to perform on the system
- Tasks are taken as series of actions, which are matched to the appropriate audit data
- If a mismatch is encountered, an alarm is produced

## Data Mining
- Set of techniques that use the process of extracting previously unknown information from large stores of data
- Suitable for large volumes of audit data (offline processing)
- Less useful for stream analysis of network traffic
- Based on analysis of co-occurrences and correlations of event records, data mining may produce:
  - Decision trees
  - Association rules
  as concise representations of discovered relationships
- Example of a rule generated by data mining:
  ```
  if for the past 2 seconds, the count of connections to the same host is greater than 4; and the percentage of those that have the same service is greater than 75%; and the percentage of those that have the "S0" flag is greater than 75%, then there is a syn flood attack.
  ```
  (taken from "Real Time Data Mining-based Intrusion Detection" by Wenke Lee et al.)

These techniques provide various approaches to intrusion detection, each with its own strengths and weaknesses. A combination of techniques may be employed to create a more robust and effective intrusion detection system, taking advantage of the strengths of each method while mitigating their weaknesses.